<!DOCTYPE HTML>
<!--
	Cross-Border Finance Visualization
	Based on "Strongly Typed" by HTML5 UP
	html5up.net | @ajlkn
    Acknowledgement: I used chatGPT for examples of how to handle dropdown menus, time sliders and embed vega and D3 outputs.
-->
<html>

<head>
    <title>Interactive Dashboard - Cross-Border Finance</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="assets/css/main.css" />
    <link rel="stylesheet" href="assets/css/fontawesome-all.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>


</head>

<body class="no-sidebar is-preload">
    <div id="page-wrapper">

        <!-- Header: Cross-Border Finance Project -->
        <section id="header">
            <div class="container">

                <!-- Logo / Project Title -->
                <h1 id="logo"><a href="index.html">Cross-Border Funding</a></h1>
                <p>Exploring cross-border lending and borrowing patterns</p>

                <!-- Nav -->
                <nav id="nav">
                    <ul>
                        <li><a class="icon solid fa-home" href="index.html"><span>Main</span></a></li>
                        <li>
                            <a href="#" class="icon fa-chart-bar"><span>Visualizations</span></a>
                            <ul>
                                <li><a href="#viz-network">Cross-border funding network</a></li>
                                <li><a href="#viz-global-growth">Exposures over time</a></li>
                            </ul>
                        </li>
                        <li><a class="icon solid fa-sitemap" href="#footer"><span>References</span></a></li>
                    </ul>
                </nav>

            </div>
        </section>

        <!-- Main: Cross-Border Finance Visualizations -->
        <section id="main">
            <div class="container">
                <div id="content">

                    <!-- Project Description  -->
                    <article class="box post">
                        <!-- Intro / Narrative -->
                        <p>
                            Global borrowing and lending among international banks connect economies and improve capital allocation, promoting investment and larger growth outcomes. 
                            However, these linkages also pose risks of crisis that can spill across borders, such as failures to roll over funding or currency shocks. 
                            Using Locational Banking Statistics (LBS) collected by the Bank of International Settlements (BIS), this project visualizes 
                            funding networks, growth, and concentration to help assess vulnerabilities and inform policy.
                        </p>

                        <hr />

                        <!-- Visualization: Cross-border Chord Diagram -->
                        <section id="viz-network">
                            <header>
                                <h3>Cross-border funding network</h3>
                                <p>
                                    The Cross-border Funding Network illustrates the origin and destination of international 
                                    funding flows. The chord diagram provides three complementary perspectives—regional, 
                                    country-to-region, and country-specific—enabling users to examine financial hubs, 
                                    key counterparties, and the concentration of exposures. 
                                </p>
                                <p>    
                                    For clarity, the country-specific view is limited to the top 15 funding providers 
                                    plus Mexico, which together account for approximately 93% of the network; 
                                    the remaining countries are aggregated under “Other countries.”
                                </p>
                            </header>

                            <div class="row gtr-150">
                                <!-- Controls Subsection -->
                                <div class="col-12">
                                    <section class="box">
                                        <form>
                                            <div class="row gtr-50">
                                                <div class="col-6 col-12-small">
                                                    <label for="c4-mode-select">Mode</label>
                                                    <select id="c4-mode-select" name="c4-mode-select">
                                                        <option value="region_region">Region to region</option>
                                                        <option value="country_region">Country to region</option>
                                                        <option value="country_country">Country to country</option>
                                                    </select>
                                                </div>

                                                <div class="col-6 col-12-small">
                                                    <label for="c4-country-select">Focus</label>
                                                    <select id="c4-country-select" name="c4-country-select">
                                                        <option value="all">All countries</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </form>
                                    </section>
                                </div>

                                <!-- Plot Subsection -->
                                <div class="col-12">
                                    <section class="box">
                                        <h4>Borrowing & Lending in Top Countries (USD trillions)</h4>
                                        <div id="chart4-container" class="viz-plot">
                                            <!-- Chord Diagram is rendered here  via JS (D3) -->
                                        </div>
                                    </section>
                                </div>
                                <!-- Date slider -->
                                <div class="col-12">
                                    <section class="box">

                                        <form>
                                            <div class="row gtr-0">
                                                <div class="col-12">
                                                    <label for="c4-date-slider">Year - Quarter</label>
                                                    <div class="c4-slider-row">
                                                        <button type="button" id="c4-date-play"
                                                            class="button small">Play</button>
                                                        <input type="range" id="c4-date-slider" min="0" max="0"
                                                            value="0" step="1" />
                                                    </div>
                                                    <div
                                                        style="display: flex; justify-content: space-between; font-size: 0.9em; margin-top: 0.35em;">
                                                        <span id="c4-date-start">...</span>
                                                        <span id="c4-date-label">Loading...</span>
                                                        <span id="c4-date-end">...</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </section>
                                </div>
                            </div>
                        </section>
                        <hr />



                        <!-- Visualization: Expositions behavior over time -->
                        <section id="viz-global-growth">
                            <header>
                                <h3>Expositions over time</h3>
                                <p>
                                    The following three complementary views help characterize the dynamics of cross-border funding for specific geographies. <br>
                                        - Levels trace the evolution of claims, liabilities, and net positions over time, highlighting periods of expansion or retrenchment. <br>
                                        - Growth rates reveal turning points and shifts in momentum. <br>
                                        - Concentration, by the Herfindahl–Hirschman Index (HHI), captures how exposures become more or less diversified, 
                                          signaling potential vulnerabilities in the funding structure.
                                </p>
                            </header>

                            <div class="row gtr-150">
                                <div class="col-12">
                                    <section class="box">
                                        <form>
                                            <div class="row gtr-50">
                                                <div class="col-12">
                                                    <label for="c-shared-entity-select">Region / Country</label>
                                                    <select id="c-shared-entity-select"
                                                        name="c-shared-entity-select"></select>
                                                    <script>
                                                        const sharedEntitySelect = document.getElementById("c-shared-entity-select");
                                                        const sharedEntityOptionsPromise = fetch("data/entity_options.json")
                                                            .then(r => r.json())
                                                            .then(options => {
                                                                sharedEntitySelect.innerHTML = "";
                                                                options.forEach(o => {
                                                                    const opt = document.createElement("option");
                                                                    opt.value = o.value;
                                                                    opt.textContent = o.label;
                                                                    sharedEntitySelect.appendChild(opt);
                                                                });
                                                                sharedEntitySelect.value = "world";
                                                            });
                                                    </script>
                                                </div>
                                            </div>
                                        </form>
                                    </section>
                                </div>
                                <div class="col-12">
                                    <section class="box">
                                        <h4>Outstanding Cross-Border Claims, Liabilities, and Net Position</h4>
                                        <p></p>
                                        <div id="chart1" class="viz-plot">
                                            <!-- Detailed/ apecific charts will be rendered here via JS (Altair / Vega-Embed) -->
                                            <script>
                                                const chart1Setup = sharedEntityOptionsPromise
                                                    .then(() => vegaEmbed("#chart1", "charts/chart1_spec.json", { actions: false }))
                                                    .then(res => {
                                                        const view = res.view;
                                                        const select = document.getElementById("c-shared-entity-select");

                                                        function updateChart1() {
                                                            const value = select.value || "world";
                                                            view.signal("entity", value).runAsync();
                                                        }

                                                        select.addEventListener("change", updateChart1);
                                                        updateChart1();
                                                    })
                                                    .catch(console.error);
                                            </script>
                                        </div>
                                    </section>
                                </div>
                                <div class="col-12">
                                    <section class="box">
                                        <h4>Quarter-over-quarter change in claims and liabilities</h4>
                                        <div id="chart1-pct-change" class="viz-plot"></div>
                                        <script>
                                            const chart1PctSetup = sharedEntityOptionsPromise
                                                .then(() => vegaEmbed("#chart1-pct-change", "charts/chart1_pct_change_spec.json", { actions: false }))
                                                .then(res => {
                                                    const view = res.view;
                                                    const select = document.getElementById("c-shared-entity-select");

                                                    function updatePctChart() {
                                                        const value = select.value || "world";
                                                        view.signal("entity", value).runAsync();
                                                    }

                                                    select.addEventListener("change", updatePctChart);
                                                    updatePctChart();
                                                })
                                                .catch(console.error);
                                        </script>
                                    </section>
                                </div>
                                <div class="col-12">
                                    <section class="box">
                                        <h4>Liability concentration by the Herfindahl–Hirschman Index</h4>
                                        <div id="chart1-hhi" class="viz-plot"></div>
                                        <script>
                                            const chart1HhiSetup = sharedEntityOptionsPromise
                                                .then(() => vegaEmbed("#chart1-hhi", "charts/chart1_hhi_spec.json", { actions: false }))
                                                .then(res => {
                                                    const view = res.view;
                                                    const select = document.getElementById("c-shared-entity-select");

                                                    function updateHhiChart() {
                                                        const value = select.value || "world";
                                                        view.signal("entity", value).runAsync();
                                                    }

                                                    select.addEventListener("change", updateHhiChart);
                                                    updateHhiChart();
                                                })
                                                .catch(console.error);
                                        </script>
                                    </section>
                                </div>
                            </div>
                        </section>

                        <hr />
                    </article>

                </div>
            </div>
        </section>

        <!-- Footer -->
        <section id="footer">
            <div class="container">
                <header>
                    <h2>References</h2>
                </header>
                <section>
                    <p>Data source: <a href="https://data.bis.org/topics/LBS"> Bank for International Settlements (BIS) – Locational Banking Statistics (LBS).</a></p>
                    <p>HTML is a modified template from <a href="https://html5up.net/">HTML5 UP</a></p>
                    <p>Affiliation: University of Chicago, Chicago, IL, USA.</p>
                    <p>Repository: <a href="https://github.com/JGro95/project_dynamic">github.com/JGro95/project_dynamic</a></p>
                    <p>Portfolio: <a href="https://jgro95.github.io">jgro95.github.io</a></p>
                    <p>Contact: <a href="jguerrero95@uchicago.edu">jguerrero95@uchicago.edu</a></p>
                </section>
            </div>
            <div id="copyright" class="container">
                <ul class="links">
                    <li>&copy; Cross-Border Finance Project. All rights reserved.</li>
                    <li>Design base: <a href="http://html5up.net">HTML5 UP</a></li>
                </ul>
            </div>
        </section>

    </div>

    <!-- Scripts -->
    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/js/jquery.dropotron.min.js"></script>
    <script src="assets/js/browser.min.js"></script>
    <script src="assets/js/breakpoints.min.js"></script>
    <script src="assets/js/util.js"></script>
    <script src="assets/js/main.js"></script>

    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="js/chart4_chord.js"></script>



</body>

</html>



{"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"url": "data/chart1_exposures.json", "format": {"type": "json"}}, "mark": {"type": "line", "point": true}, "encoding": {"color": {"field": "Position", "legend": {"orient": "top", "title": "Position"}, "scale": {"domain": ["Claims", "Liabilities"], "range": ["#2A9D8F", "#B91C1C"]}, "type": "nominal"}, "tooltip": [{"field": "date", "format": "%Y-%m", "title": "Date", "type": "temporal"}, {"field": "Position", "title": "Position", "type": "nominal"}, {"field": "pct_change", "format": ",.1f", "title": "QoQ change (%)", "type": "quantitative"}], "x": {"axis": {"format": "%Y"}, "field": "date", "timeUnit": "yearmonth", "title": "", "type": "temporal"}, "y": {"field": "pct_change", "title": "Quarter-over-quarter change (%)", "type": "quantitative"}}, "height": 300, "params": [{"name": "entity", "value": "world"}], "title": "Quarter-over-quarter changes in cross-border positions", "transform": [{"lookup": "L_REP_CTY", "from": {"data": {"url": "data/chart1_metadata.json", "format": {"type": "json"}}, "key": "L_REP_CTY", "fields": ["country_name_rep", "region_rep"]}}, {"filter": "entity == 'world' || datum.country_name_rep == entity || datum.region_rep == entity"}, {"aggregate": [{"op": "sum", "field": "OBS_VALUE", "as": "total_obs"}], "groupby": ["date", "L_POSITION"]}, {"window": [{"op": "lag", "field": "total_obs", "as": "prev_total"}], "groupby": ["L_POSITION"], "sort": [{"field": "date"}]}, {"calculate": "datum.prev_total ? (datum.total_obs - datum.prev_total) / datum.prev_total * 100 : null", "as": "pct_change"}, {"calculate": "datum.L_POSITION == 'C' ? 'Claims' : 'Liabilities'", "as": "Position"}, {"filter": "isValid(datum.pct_change)"}], "width": 800, "$schema": "https://vega.github.io/schema/vega-lite/v5.8.0.json"}